<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400&display=swap" rel="stylesheet">
  <title>ğŸ‘»æ‰é¬¼å¤§ä½œæˆ°ğŸ‘»</title>
  <style>
    body {
      margin: 0;
      font-family: 'Noto Sans TC', sans-serif;
      font-size: 20px;
    }

    .title_text {
      /*width: 800px;
      height: 500px;
      background: rgba(255, 255, 255, 0.5);*/
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 3;
    }


    .title_text img {
      scale: 120%;
    }

    #game {
      width: 100vw;
      height: 100vh;
      background-image: url(./bg2.png);
      background-repeat: no-repeat;
      background-size: cover;
      overflow: hidden;
      position: relative;
      cursor: url(./net1.png) 50 50, auto;
      margin: auto;
    }

    #game>img {
      height: 300px;
      position: absolute;
      /*è®“åœ–ç‰‡ä¸èƒ½åç™½*/
      user-select: none;
      -webkit-user-drag: none;
    }

    .bt {
      width: 100px;
      height: 100px;
      /*background: lemonchiffon;*/
      position: absolute;
      top: 100px;
      left: 100px;
      z-index: 2;
    }

    #music {
      padding: 10px;
      position: absolute;
      top: 3%;
      left: 1%;
      z-index: 1;
    }

    marquee {
      font-size: 30px;
      color: rgba(255, 255, 255, 0.5);
      position: absolute;
      bottom: 2%;
      z-index: 1;
    }

    .sc {
      width: 300px;
      height: 200px;
      /*background: rgba(255, 255, 255, 0.5);*/
      color: white;
      text-align: center;
      position: absolute;
      top: 3%;
      left: 40%;
      z-index: 1;
    }

    .sc1 {
      padding: 10px;
      background: rgba(255, 255, 255, 0.5);
      position: absolute;
      top: 5%;
      right: 2%;
      z-index: 1;
    }

    .blood {
      /*å¿½ç•¥é»æ“Šäº‹ä»¶*/
      pointer-events: none;
    }

    #text-time,
    #text-score {
      font-size: 30px;
      font-weight: bolder;
      color: lightblue;
      margin: 10px;
    }

    #text-highscorename,
    #text-highscore {
      color: rgb(26, 28, 167);
      margin: 10px;
    }
  </style>
</head>

<body>
  <div id="music"><audio autoplay="autoplay" controls="controls" loop="loop" preload="auto" src="./music.mp3">
    </audio></div>

  <div class="title_text">
    <img class="ghost" src="./title2.gif" alt="æ‰é¬¼å¤§ä½œæˆ°">
  </div>

  <div id="btn-start"></div>
  <!---- <div class="bt"> <input type="button" value="é–‹å§‹" id="btn-start">
  </div>---->
  <div class="sc">
    <p>å‰©é¤˜ <span id="text-time">0</span> ç§’</p>
    <p>æŠ“åˆ° <span id="text-score">0</span>éš»</p>
  </div>

  <div class="sc1">
    <p>âœ¦æœ€é«˜åˆ†ç©å®¶ï¼š <span id="text-highscorename">æ²’æœ‰äºº</span></p>
    <p>âœ¦æœ€é«˜åˆ†åˆ†æ•¸ï¼š <span id="text-highscore">0</span></p>
  </div>

  <!---- 
  <marquee>
    æ­¡æ¨‚çš„è¬è–ç¯€å¤œæ™šï¼Œå‹‡æ•¢çš„å°å¤¥ä¼´å€‘é—–å…¥äº†ç¥ç§˜çš„å¢³å¢“ã€‚å¢“ä¸­çš„å¹½éˆå€‘æ—è›‹ä¸åœï¼Œå¿«ä¾†èˆ‡å®ƒå€‘ç©æ‰è¿·è—ï¼èº²è²“è²“èˆ‡å¹½éˆå€‘å±•é–‹äº†ç˜‹ç‹‚çš„å°‹é¬¼å¤§ä½œæˆ°ï¼Œä¸€é‚Šå°‹æ‰¾å®ƒå€‘è—èº«ä¹‹è™•ï¼Œä¸€é‚Šå°å¿ƒä¸è¦è¢«å®ƒå€‘æŠ“ä½ã€‚å¿«ä¾†åŠ å…¥é€™å ´é­”å¹»åˆå¯æ„›çš„å†’éšªï¼Œè®“æˆ‘å€‘ä¸€èµ·æ‰è¿·è—èˆ‡å¹½éˆå€‘å…±åº¦è¬è–ç¯€ï¼
  </marquee>
  ---->



  <div id="game"></div>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.js'
    integrity='sha512-6DC1eE3AWg1bgitkoaRM1lhY98PxbMIbhgYCGV107aZlyzzvaWCW1nJW2vDuYQm06hXrW0As6OGKcIaAVWnHJw=='
    crossorigin='anonymous'></script>

  <script>
    // åˆ†æ•¸
    let score = 0
    // å‰©é¤˜ç§’æ•¸
    let countdown = 0
    // è¨ˆæ™‚å™¨
    let timer = 0
    //æœ€é«˜åˆ†
    //localStorage ç”¨æ–¼é•·ä¹…ä¿å­˜æ•´å€‹ç¶²ç«™çš„æ•¸æ“šï¼Œä¿å­˜çš„æ•¸æ“šæ²’æœ‰éæœŸæ™‚é–“ï¼Œç›´åˆ°æ‰‹å‹•å»åˆªé™¤ã€‚
    //JSON.parse()ï¼šJSON è®Šç‰©ä»¶ï¼Œå¯ä»¥æ¥æ”¶ JSON å­—ä¸²ï¼Œè½‰ç‚º Javascript ç‰©ä»¶æˆ–æ˜¯å€¼ã€‚
    const highscore = localStorage.zombie ? JSON.parse(localStorage.zombie) : { name: '', score: 0 }
    let tag = true


    $('#text-highscorename').text(highscore.name)
    $('#text-highscore').text(highscore.score)

    //é–‹é ­å‹•ç•«
    $('body').click(function () {
      setTimeout(function () {
        $('.ghost').fadeOut(500, function () {
        }).delay(1000).queue(function () {
          $(this).remove()
        })
      }, 500)
    })


    $('#btn-start').click(function () {
      // åœç”¨ é–‹å§‹æŒ‰éˆ•
      $(this).attr('disabled', true)
      // é‡è¨­
      score = 0
      $('#text-score').text(score)
      countdown = 20
      $('#text-time').text(countdown)
      // é–‹å§‹éŠæˆ²
      //setInterval ç”¨é€”å°±æ˜¯å°±æ˜¯è¨­å®šä¸€å€‹å®šæ™‚å™¨ï¼Œæœƒä¸æ–·åœ°åŸ·è¡Œè§¸ç™¼äº‹ä»¶
      timer = setInterval(function () {
        // å€’æ•¸
        countdown--
        $('#text-time').text(countdown)
        // éš¨æ©Ÿ 1~10
        //.ceil å–æ•´æ•¸
        const random = Math.ceil(Math.random() * 20)
        // å¦‚æœéš¨æ©Ÿæ•¸å­— > 5 ä¸”å ´ä¸Šä¸è¶…é 5 å€‹æ‰ç”¢ç”Ÿ
        if (random > 5 && $('.zombie').length < 5) {
          // éš¨æ©Ÿä½ç½®
          const top = Math.round(Math.random() * 100) + '%'
          const left = Math.round(Math.random() * 100) + '%'
          // ç”¢ç”Ÿ
          const zombie = $(`<img src="./ghost1.gif" class="zombie" style="top: ${top}; left: ${left}">`)
          $('#game').append(zombie)
          move(zombie)
        }
        //æ™‚é–“åˆ°
        if (countdown === 0) {
          clearInterval(timer)
          //éŠæˆ²å€åŸŸæ¸…ç©º
          $('#game').html('')
          //é‡æ–°å•Ÿç”¨ é–‹å§‹æŒ‰éˆ•
          //é€™è£¡å› ç‚º setInterval ç”¨ function æ‰€ä»¥ this æœƒæŒ‡åˆ° window
          //æ‰€ä»¥ç”¨ $('#btn-start')
          $('#btn-start').attr('disabled', false)
          /*alert(`ä½ å¾—äº†${score}åˆ†`)*/

          if (score > highscore.score) {
            /*highscore.name = prompt('æœ€é«˜åˆ†ï¼Œè«‹è¼¸å…¥åå­—') || 'è·¯äºº'*/
            Swal.fire({
              icon: 'info',
              title: 'æ™‚é–“åˆ°',
              text: `æœ€é«˜åˆ†ï¼Œä½ æŠ“åˆ°${score}éš»é¬¼`,
              input: 'text',
              inputPlaceholder: 'è«‹è¼¸å…¥åå­—',
              inputAttributes: {
                required: true
              },
              validationMessage: 'åç¨±å¿…å¡«',
              allowOutsideClick: false,
              allowEscapeKey: false
            }).then(function (result) {
              highscore.name = result.value
              highscore.score = score
              $('#text-highscorename').text(highscore.name)
              $('#text-highscore').text(highscore.score)

              //JSON.stringify() ï¼šå°‡ä»»ä½•ç‰©ä»¶è½‰è®Šç‚º JSON å­—ä¸²çš„æ–¹æ³•
              localStorage.zombie = JSON.stringify(highscore)
            })
          } else {
            Swal.fire({
              icon: 'info',
              title: 'æ™‚é–“åˆ°!',
              text: `ä½ æŠ“åˆ°${score}éš»é¬¼`
            })
          }
        }
      }, 1000)
    })

    // éŠæˆ²é–‹å§‹å¾Œåœ–ç‰‡æ¶ˆå¤±
    const button = $('#btn-start');
    const img = $('.title_text');
    $('#btn-start').on('click', function () {

    })

    $('body').click(function (event) {
      if ($(event.target).hasClass('swal2-confirm')) return

      if (tag == true) {
        tag = false
        // é‡è¨­
        score = 0
        $('#text-score').text(score)
        countdown = 20
        $('#text-time').text(countdown)
        // é–‹å§‹éŠæˆ²
        timer = setInterval(function () {
          // å€’æ•¸
          countdown--// count æ•¸  count on æŒ‡æœ›  count(me)in è®“(æˆ‘)åƒåŠ   count (me) out ä¸è¦ç®—ä¸Š(æˆ‘)
          $('#text-time').text(countdown)
          // éš¨æ©Ÿ 1~10
          const random = Math.ceil(Math.random() * 20)//ceiling å¤©èŠ±æ¿ï¼Œåœ¨é€™é‚Šæ˜¯ç„¡æ¢ä»¶é€²ä½
          // å¦‚æœéš¨æ©Ÿæ•¸å­— > 5 ä¸”å ´ä¸Šä¸è¶…é 5 å€‹æ‰ç”¢ç”Ÿ
          if (random > 5 && $('.zombie').length < 10) {
            // éš¨æ©Ÿä½ç½®
            const top = Math.round(Math.random() * 100) + '%'//roundå››æ¨äº”å…¥
            const left = Math.round(Math.random() * 100) + '%'
            // ç”¢ç”Ÿ
            const zombie = $(`<img src="./ghost1.gif" class="zombie" style="top: ${top}; left: ${left}">`)
            $('#game').append(zombie)//appendåŠ åœ¨å¾Œé¢ã€prependåŠ åœ¨å‰é¢ã€pendæ‡¸æ›ã€pre(é–‹é ­çš„å–®å­—é€šå¸¸æœ‰å‰çš„æ„æ€)
            move(zombie)
            $(function () {
            });
          }
          if (countdown == 5) {
            $('#text-time').addClass('red');

          }
          // æ™‚é–“åˆ°
          else if (countdown === 0) {
            clearInterval(timer)// Interval é–“éš”
            // éŠæˆ²å€åŸŸæ¸…ç©º
            $('#game').html('')
            // é‡æ–°å•Ÿç”¨é–‹å§‹æŒ‰éˆ•
            // tag = true

            if (score > highscore.score) {
              Swal.fire({
                icon: 'info',
                title: 'æ™‚é–“åˆ°',
                text: `æœ€é«˜åˆ†ï¼Œä½ å¾—åˆ° ${score} åˆ†`,
                input: 'text',
                inputPlaceholder: 'è«‹è¼¸å…¥ç©å®¶åå­—',//place ä½ç½®  hold æŠ“ã€æ¡  holderæŒæœ‰è€…  placeholderæµ®æ°´å°(ä½”ä½ç¬¦)
                inputAttributes: {//attributes å±¬æ€§
                  required: true //required å¿…é ˆçš„
                },
                validationMessage: 'åç¨±å¿…å¡«',//validation é©—è­‰
                allowOutsideClick: false,// allow å…è¨±
                allowEscapeKey: false //escape é€ƒè„«ã€è·³è„« key æŒ‰éµã€éŸ³æº–ã€é‘°åŒ™ã€é—œéµç­‰ç­‰éå¸¸å¤š...
              }).then(function (result) {// result çµæœ
                highscore.name = result.value
                highscore.score = score
                $('#text-highscorename').text(highscore.name)
                $('#text-highscore').text(highscore.score)

                localStorage.zombie = JSON.stringify(highscore)// localç•¶åœ°çš„  storageå„²è—åº«(é•·æœŸå„²å­˜è³‡æ–™è¨­å‚™ä½¿ç”¨é€™å€‹)  memory è¨˜æ†¶é«”(çŸ­æœŸè¨˜æ†¶ä½¿ç”¨) string å­—ä¸²  stringify è½‰æˆå­—ä¸²
              }).then(() => {
                tag = true
              })

            } else {
              Swal.fire({
                icon: 'info',
                title: 'æ™‚é–“åˆ°',
                text: `ä½ å¾—åˆ° ${score} åˆ†`
              }).then(() => {
                tag = true
              })
            }
          }
        }, 1000)

      }
    })


    function move(zombie) {
      //éš¨æ©Ÿä½ç½®
      const top = Math.round(Math.random() * 100) + `%`
      const left = Math.round(Math.random() * 100) + `%`
      zombie.animate({ top, left }, 2000, function () {
        move(zombie)
      })
    }
    //è¨ˆç®—ç¸½åˆ†
    $('#game').on('click', '.zombie', function () {
      $(this).attr('src', './fire1.gif')
      $(this).removeClass('zombie').addClass('blood')
      $(this).stop()
      score++
      $('#text-score').text(score)
    })

    // æ¸¸æ¨™è®Šæ›
    $('#game').on('mousedown', function () {
      $('#game').css({
        'cursor': 'url(./net2.png) 50 50, auto'
      })
    })
    $('#game').on('mouseup', function () {
      $('#game').css({
        'cursor': 'url(./net1.png) 50 50, auto'
      })
    })
  </script>



</body>

</html>